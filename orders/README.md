# 発注書管理ディレクトリ

## 📁 ディレクトリ構造

```
orders/
├── README.md                           # このファイル
├── [G-ID]_[顧客名]_発注書.xlsx        # アクティブな発注書
└── archive/                           # 処理済み発注書のアーカイブ
    └── 2025-01/                      # 年月別アーカイブ
        └── 処理済み発注書.xlsx
```

## 📝 発注書の保存手順

### 1. 新規発注書の保存
新しい発注書は `orders/` ディレクトリ直下に保存してください。

**命名規則**：
```
[G-ID]_[顧客名]_発注書.xlsx
```

**例**：
- `G1234567_[サンプル]企業名_発注書.xlsx`
- `G2345678_[サンプル]商事名_発注書.xlsx`

### 2. 発注書の処理
```bash
# Excel解析を実行
node tools/excel_analyzer.js orders/G1234567_[サンプル]企業名_発注書.xlsx

# 記事プロンプト生成
node tools/article_generator.js G1234567 01
```

### 3. 処理完了後のアーカイブ
処理が完了した発注書は、年月別のアーカイブディレクトリに移動してください。

```bash
# アーカイブディレクトリを作成（まだない場合）
mkdir -p orders/archive/2025-01

# 発注書をアーカイブ
mv orders/G1234567_[サンプル]企業名_発注書.xlsx orders/archive/2025-01/
```

## 🔍 発注書の検索

### アクティブな発注書を確認
```bash
ls -la orders/*.xlsx
```

### アーカイブ済み発注書を検索
```bash
find orders/archive -name "*.xlsx"
```

### 特定のG-IDで検索
```bash
find orders -name "G1234567*.xlsx"
```

## ⚠️ 注意事項

1. **機密情報の取り扱い**
   - 発注書には顧客情報が含まれているため、適切に管理してください
   - Gitにはコミットしないよう `.gitignore` で除外設定済み

2. **バックアップ**
   - 重要な発注書は別途バックアップを取ることを推奨

3. **ファイル形式**
   - Excel形式（.xlsx）のみ対応
   - 他の形式の場合は事前に変換が必要

## 📊 処理状況の確認

### 処理済み顧客一覧
```bash
ls -d customers/G*
```

### 未処理の発注書
```bash
# orders直下の発注書が未処理
ls orders/*.xlsx 2>/dev/null
```

## 🔄 ワークフロー概要

1. **発注書受領** → `orders/` に保存
2. **Excel解析** → `customers/[G-ID]/` にデータ生成
3. **記事作成** → `output/[G-ID]/` にプロンプト生成
4. **完了後** → `orders/archive/` にアーカイブ

---

最終更新: 2025年1月6日